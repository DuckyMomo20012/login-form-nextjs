/*----------------------------------------------------------
MASV: 19127631
HO TEN CAC THANH VIEN NHOM:
+ DUONG TIEN VINH - 19127631
+ TRAN PHAN THANH HAI - 19127005
+ NGUYEN LE HUU SANG - 19127538
LAB: 03 - NHOM
NGAY: 20/04/2022
----------------------------------------------------------*/

USE [QLSVNhom]
GO

CREATE TABLE [dbo].[SINHVIEN] (
MASV VARCHAR(20) NOT NULL,
HOTEN NVARCHAR(100) NOT NULL,
NGAYSINH DATETIME NULL,
DIACHI NVARCHAR(200) NULL,
MALOP VARCHAR(20) NULL,
TENDN NVARCHAR(100) NOT NULL,
MATKHAU VARBINARY(16) NOT NULL,
PRIMARY KEY (MASV)
)

CREATE TABLE [dbo].[NHANVIEN] (
MANV VARCHAR(20) NOT NULL,
HOTEN NVARCHAR(100) NOT NULL,
EMAIL VARCHAR(20) NULL,
LUONG VARBINARY(MAX) NULL,
TENDN NVARCHAR(100) NOT NULL,
MATKHAU VARBINARY(20) NOT NULL,
PUBKEY VARCHAR(20) NULL,
PRIMARY KEY (MANV)
);

CREATE TABLE [dbo].[LOP] (
MALOP VARCHAR(20) NOT NULL,
TENLOP NVARCHAR(100) NOT NULL,
MANV VARCHAR(20) NULL,
PRIMARY KEY (MALOP)
);

CREATE TABLE [dbo].[HOCPHAN] (
MAHP VARCHAR(20) NOT NULL,
TENHP NVARCHAR(100) NOT NULL,
SOTC INT NULL,
MALOP VARCHAR(20) NOT NULL,
PRIMARY KEY (MAHP)
);

CREATE TABLE [dbo].[BANGDIEM] (
MASV VARCHAR(20) NOT NULL,
MAHP VARCHAR(20) NOT NULL,
DIEMTHI VARBINARY(MAX),
PRIMARY KEY(MASV, MAHP)
);

ALTER TABLE [dbo].[SINHVIEN]
ADD FOREIGN KEY ([MALOP]) REFERENCES LOP([MALOP]);

ALTER TABLE [dbo].[LOP]
ADD FOREIGN KEY ([MANV]) REFERENCES NHANVIEN([MANV]);

ALTER TABLE [dbo].[HOCPHAN]
ADD FOREIGN KEY ([MALOP]) REFERENCES LOP([MALOP]);

ALTER TABLE [dbo].[BANGDIEM]
ADD FOREIGN KEY ([MASV]) REFERENCES SINHVIEN([MASV]),
	FOREIGN KEY ([MAHP]) REFERENCES HOCPHAN([MAHP]);

--USE [master] 
--GO
--DROP DATABASE [QLSV]
--GO


DROP TABLE BANGDIEM
GO
DROP TABLE HOCPHAN
GO
DROP TABLE SINHVIEN
GO
DROP TABLE LOP
GO
DROP TABLE NHANVIEN
GO
